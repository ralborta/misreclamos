# Railway configuration
# Usar preDeployCommand es mejor pr√°ctica que startCommand para migraciones

[build]
builder = "nixpacks"

[deploy]
startCommand = "pnpm start"
restartPolicyType = "ON_FAILURE"
restartPolicyMaxRetries = 10

# preDeployCommand se ejecuta SOLO durante deploys, no en restarts
# Esto evita ejecutar migraciones en cada restart del contenedor
[deploy.preDeployCommand]
command = "pnpm prisma migrate deploy"
